"use client";

import React, { useState } from "react";

import star from "@/public/assets/stars.png";
import Image from "next/image";
import { Nunito_Sans } from "next/font/google";
import { ChevronDown, ChevronUp } from "lucide-react";
import { motion, AnimatePresence } from "framer-motion";
import LeaderboardItems from "./LeaderBoardItem";
import CallDetailsProps from "./type";

const nunitoSans = Nunito_Sans({
  subsets: ["latin"],
  weight: ["400", "700"],
});

const CallDetails = ({ data, isOpen, toggleDropdown }:CallDetailsProps) => (
  <div>
    <div className="h-[54px] w-full grid grid-cols-3 border-b border-b-[#262246] bg-[#111736]">
      <div className="w-full xs:w-[101px] h-full flex items-center justify-center">
        <h3 className="text-mainColor text-[12px]">
          {data.SNo}{" "}
          <span className={data.isPlus ? "text-[#16B967]" : "text-[#E53E3E]"}>
            {data.isPlus || data.isMinus}
          </span>
        </h3>
      </div>
      <div className="w-full xs:w-[194px] h-full flex items-center justify-start ">
        <div className="flex items-center">
          <Image
            src={data.image}
            alt="Influencer Avatar"
            className="w-[26px] h-[26px] hidden xs:flex"
          />
          <p className="text-[12px] text-mainColor ml-2">{data.Influencer}</p>
        </div>
      </div>
      <div className="flex items-center justify-end ml-8 xs:ml-12 xsm:ml-20">
        <button
          onClick={toggleDropdown}
          className="w-full h-full flex justify-center items-center"
          aria-expanded={isOpen}
          aria-label="Toggle details"
        >
          {isOpen ? (
            <ChevronUp className="h-4 w-4 text-white" />
          ) : (
            <ChevronDown className="h-4 w-4 text-white" />
          )}
        </button>
      </div>
    </div>

    <AnimatePresence>
      {isOpen && (
        <motion.div
          className="bg-[#111736] px-4 py-3 text-mainColor"
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: "auto", opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          transition={{ duration: 0.3 }}
        >
          {[
            {
              label: "Average Buy Volume",
              value: data.AverageBuyVolume,
            },
            { label: "Highest Buy Volume", value: data.HighestBuyvolume },
            { label: "Average Xs", value: data.AverageXs },
            { label: "Highest Xs", value: data.HighestXs },
            {
              label: "Average Follow up Call Volume",
              value: data.AverageFollowup,
            },
            {
              label: "Highest Follow up Call Volume",
              value: data.HighestFollowup,
            },
            { label: "Number of Calls", value: data.NumberofCalls },
          ].map((item, index) => (
            <div key={index} className="grid grid-cols-3 py-2">
              <h2 className="text-[12px] font-bold text-mainColor">
                {item.label}
              </h2>
              <p
                className={`${nunitoSans.className} text-[12px] xs:text-[14px] text-mainColor col-span-2 ml-4`}
              >
                {item.value}
              </p>
            </div>
          ))}
        </motion.div>
      )}
    </AnimatePresence>
  </div>
);

const LeaderBoardResponsive = () => {
  const [openIndexes, setOpenIndexes] = useState<number[]>([]);

  const toggleDropdown = (index: number) => {
    setOpenIndexes((prev) =>
      prev.includes(index) ? prev.filter((i) => i !== index) : [...prev, index]
    );
  };

  return (
    <div className="mt-8 container w-full h-auto py-2">
      <div className="w-full h-[136px] flex sm:hidden justify-center items-center rounded-[6px]  p-4  bg-gradient-to-r from-[#6E62E5] to-[#62A3E5] text-white relative overflow-hidden">
        <div className="absolute">
          <svg
            width="230"
            height="136"
            viewBox="0 0 196 136"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            className="-mt-4 -ml-6"
          >
            <path
              d="M60.8009 19.7912C62.2198 19.7912 63.6631 19.5772 65.0862 19.1282C72.5856 16.7598 76.7603 8.73184 74.3922 1.23289C73.245 -2.40023 70.7521 -5.36926 67.372 -7.12688C63.9919 -8.88526 60.1295 -9.22132 56.4968 -8.0742C48.9975 -5.70609 44.8227 2.32145 47.1905 9.82116C49.1096 15.8978 54.7426 19.7912 60.8009 19.7912ZM53.2319 1.59536C54.2822 -0.424061 56.0555 -1.91375 58.2261 -2.59888C59.072 -2.86604 59.9393 -2.99886 60.8017 -2.99886C62.152 -2.99886 63.4913 -2.6739 64.7237 -2.03355C66.7432 -0.983267 68.2325 0.790423 68.918 2.96103C70.3327 7.44157 67.8382 12.2379 63.3577 13.6529C58.8772 15.0695 54.0808 12.5736 52.6658 8.09302C51.9807 5.92203 52.1816 3.61439 53.2319 1.59536Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M91.1843 138.748L77.3737 139.837L68.6469 129.079C67.1755 127.264 64.1705 127.946 63.6259 130.218L61.4633 139.234C60.6251 142.727 66.1708 144.227 67.0462 140.573L67.8523 137.213L73.8657 144.626C74.4609 145.361 75.3814 145.754 76.3211 145.68L85.8376 144.929L80.6451 152.939C80.1311 153.732 80.0404 154.727 80.4021 155.6L84.0566 164.418L74.8341 161.955C73.9216 161.711 72.9471 161.932 72.2287 162.546L64.9713 168.747L64.4641 159.214C64.414 158.271 63.9026 157.412 63.0969 156.919L54.9568 151.933L58.4525 150.588C61.8051 149.297 59.8967 143.882 56.3906 145.229L47.4663 148.664C45.2865 149.503 45.0063 152.571 46.9978 153.791L58.8112 161.027L59.5472 174.861C59.6701 177.177 62.4719 178.434 64.2785 176.891L74.8108 167.892L88.195 171.466C90.4513 172.069 92.4818 169.752 91.5877 167.594L86.2839 154.796L93.8196 143.172C95.0872 141.215 93.5149 138.557 91.1843 138.748Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M177.135 30.9453C177.404 29.8859 177.047 28.7663 176.216 28.0567L168.753 21.6846C166.021 19.3517 162.168 23.6125 165.025 26.051L168.065 28.6465L158.729 30.6384C157.805 30.8359 157.038 31.4751 156.676 32.3478L153.024 41.168L148.245 32.905C147.772 32.0871 146.927 31.5543 145.985 31.4804L136.468 30.7333L142.85 23.6339C143.482 22.9312 143.727 21.9628 143.506 21.0442L141.276 11.7624L150 15.6382C150.863 16.0217 151.86 15.9559 152.666 15.4621L160.769 10.4943L160.399 13.8541C160.007 17.4249 165.696 18.2145 166.106 14.4815L167.116 5.29879C167.372 2.97011 164.759 1.31316 162.762 2.5376L150.952 9.77819L138.292 4.15397C136.158 3.20704 133.789 5.1767 134.335 7.44797L137.572 20.9175L128.311 31.2202C126.749 32.9567 127.892 35.8186 130.221 36.0008L144.032 37.0851L150.968 49.0769C152.124 51.0756 155.215 50.8892 156.105 48.7377L161.404 35.9376L174.952 33.0467C176.02 32.8197 176.867 32.0048 177.135 30.9453Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M8.40544 92.6051C10.9745 93.7212 12.3486 94.4052 13.0663 96.5873C13.7839 98.769 13.0839 100.135 11.6788 102.558C10.1508 105.194 8.2489 108.473 9.80442 113.203C11.3596 117.932 14.8365 119.443 17.6306 120.657C20.1993 121.773 21.573 122.457 22.2907 124.638C23.008 126.819 22.3079 128.185 20.9032 130.608C19.3748 133.243 17.4729 136.522 19.0281 141.251C20.1671 144.716 25.6463 142.999 24.4819 139.458C23.7647 137.276 24.4647 135.911 25.8694 133.488C27.3978 130.853 29.2997 127.574 27.7446 122.844C26.1894 118.115 22.7121 116.604 19.9184 115.391C17.3497 114.275 15.9756 113.591 15.2583 111.409C14.5406 109.228 15.2407 107.861 16.6458 105.438C18.1741 102.803 20.0757 99.5234 18.5205 94.7937C16.9654 90.064 13.4881 88.5528 10.6939 87.3387C8.12527 86.2226 6.75117 85.5386 6.03351 83.3569C5.31584 81.1748 6.0159 79.8084 7.421 77.3852C8.94934 74.7495 10.8509 71.4701 9.29535 66.74C8.17273 63.3273 2.66794 64.9655 3.84147 68.5336C4.55913 70.7157 3.85907 72.0821 2.45398 74.5053C0.925633 77.141 -0.975898 80.4204 0.579621 85.1505C2.13437 89.8802 5.61171 91.391 8.40544 92.6051Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M113.618 23.4024C114.683 22.2277 114.594 20.4119 113.419 19.3474C112.244 18.2822 110.428 18.3718 109.364 19.5465C107.821 21.2486 106.287 21.3125 103.487 21.2911C100.442 21.265 96.6494 21.2325 93.3057 24.9207C89.9623 28.6097 90.3665 32.3791 90.6915 35.4083C90.99 38.1928 91.0742 39.7257 89.5317 41.4279C87.9892 43.1296 86.4521 43.1962 83.6549 43.1721C80.6066 43.1464 76.8177 43.1124 73.4744 46.8014C70.131 50.49 70.5359 54.2594 70.8609 57.2881C71.1598 60.0727 71.244 61.6048 69.7019 63.3066C68.1602 65.0079 66.6261 65.0741 63.8262 65.05C60.7791 65.0251 56.9891 64.9899 53.6461 68.6781C52.5813 69.8528 52.6704 71.6686 53.8455 72.7334C54.3951 73.2314 55.0849 73.4768 55.7723 73.4768C56.5543 73.4768 57.3335 73.1591 57.9004 72.534C59.4425 70.8327 60.9743 70.7676 63.7761 70.7906C66.8228 70.8151 70.6132 70.8507 73.9562 67.1621C77.2996 63.4734 76.8947 59.7041 76.5697 56.6753C76.2708 53.8908 76.1866 52.3586 77.7287 50.6569C79.2708 48.9547 80.8018 48.8881 83.6055 48.9126C86.6488 48.9368 90.4427 48.972 93.7864 45.2834C97.1302 41.5947 96.7256 37.825 96.4007 34.7958C96.1021 32.0113 96.0179 30.4784 97.5604 28.7766C99.1033 27.0749 100.639 27.006 103.438 27.032C106.483 27.06 110.275 27.091 113.618 23.4024Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M128.233 93.1335C131.866 91.9864 134.835 89.4931 136.593 86.113C138.35 82.7333 138.687 78.8713 137.54 75.2382C136.392 71.6054 133.899 68.6368 130.519 66.8788C127.139 65.1212 123.277 64.7843 119.644 65.9314C116.011 67.0786 113.042 69.5718 111.285 72.952C109.527 76.3317 109.191 80.1941 110.338 83.8268C111.485 87.4599 113.978 90.4286 117.358 92.1866C119.421 93.259 121.662 93.8026 123.922 93.8026C125.366 93.8026 126.817 93.5806 128.233 93.1335ZM116.378 75.601C117.429 73.5816 119.202 72.0919 121.373 71.4068C122.219 71.1396 123.086 71.0072 123.949 71.0072C125.299 71.0072 126.638 71.3317 127.871 71.9725C129.89 73.0224 131.38 74.7961 132.065 76.9667C132.75 79.1373 132.55 81.4445 131.499 83.4643C130.449 85.4834 128.676 86.9731 126.505 87.6586C124.335 88.3437 122.028 88.1435 120.008 87.0925C115.838 84.9253 114.211 79.77 116.378 75.601Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M188.044 125.546C184.664 123.788 180.802 123.452 177.169 124.599C173.536 125.746 170.567 128.239 168.809 131.619C167.051 134.999 166.715 138.861 167.862 142.494C169.009 146.127 171.502 149.095 174.882 150.853C178.046 152.499 180.878 147.5 177.531 145.759C175.512 144.709 174.023 142.936 173.337 140.765C172.651 138.595 172.852 136.287 173.903 134.267C174.953 132.248 176.727 130.759 178.897 130.073C181.067 129.388 183.375 129.588 185.395 130.639C189.563 132.807 191.191 137.963 189.023 142.131C188.548 143.044 187.923 143.853 187.167 144.534C184.498 146.938 188.218 151.313 191.01 148.8C192.278 147.658 193.323 146.305 194.117 144.779C197.746 137.803 195.021 129.174 188.044 125.546Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M155.158 103.05C153.643 102.584 152.036 103.435 151.57 104.95C150.896 107.146 149.535 107.857 146.988 109.024C144.219 110.292 140.772 111.871 139.309 116.63C137.846 121.389 139.812 124.631 141.391 127.236C142.844 129.631 143.57 130.983 142.895 133.179C142.22 135.374 140.86 136.085 138.314 137.251C135.544 138.519 132.097 140.098 130.634 144.857C129.172 149.616 131.137 152.857 132.717 155.462C134.169 157.857 134.895 159.209 134.221 161.404C133.546 163.598 132.186 164.309 129.64 165.475C126.87 166.743 123.423 168.321 121.96 173.08C120.859 176.664 126.36 178.308 127.448 174.766C128.123 172.571 129.483 171.861 132.03 170.695C134.799 169.427 138.246 167.849 139.709 163.09C141.171 158.331 139.206 155.09 137.626 152.485C136.174 150.09 135.448 148.738 136.122 146.543C136.797 144.348 138.158 143.637 140.704 142.471C143.474 141.203 146.921 139.624 148.383 134.865C149.846 130.106 147.88 126.864 146.301 124.259C144.849 121.864 144.123 120.512 144.797 118.316C145.472 116.121 146.832 115.41 149.379 114.243C152.149 112.975 155.596 111.396 157.058 106.637C157.524 105.121 156.673 103.515 155.158 103.05Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M168.824 81.289C167.638 82.3416 167.531 84.1559 168.583 85.3416L179.716 97.8777C182.054 100.511 186.527 96.9005 184.009 94.065L172.876 81.529C171.824 80.3432 170.009 80.2361 168.824 81.289Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M101.03 107.424L84.4008 109.562C80.7072 110.037 81.4834 115.728 85.133 115.256L101.762 113.118C105.325 112.66 104.755 106.938 101.03 107.424Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M52.6985 111.345C55.1876 111.345 56.43 108.355 54.8439 106.569L43.711 94.0326C41.3261 91.346 36.9244 95.0369 39.4181 97.8452L50.5509 110.381C51.1185 111.02 51.9066 111.345 52.6985 111.345Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M2.87957 7.88531C3.55743 7.88531 4.23797 7.64647 4.78455 7.16075L17.3202 -3.97208C18.5056 -5.02466 18.6131 -6.83892 17.5606 -8.0247C16.508 -9.21047 14.6933 -9.31764 13.5079 -8.26468L0.972303 2.86853C-0.213091 3.92111 -0.320645 5.73537 0.731933 6.92115C1.29918 7.55997 2.08765 7.88531 2.87957 7.88531Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M22.021 33.5201C20.9684 32.3347 19.1538 32.2271 17.9684 33.2801C16.783 34.3327 16.6754 36.1469 17.728 37.3327L28.8609 49.8687C29.4281 50.5076 30.2166 50.8333 31.0085 50.8333C31.6864 50.8333 32.3669 50.5944 32.9135 50.1087C34.0989 49.0561 34.2064 47.2419 33.1538 46.0561L22.021 33.5201Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M190.436 10.5374C191.764 13.9213 197.145 11.9149 195.781 8.43985L189.655 -7.16701C188.342 -10.5111 182.938 -8.56522 184.31 -5.06951L190.436 10.5374Z"
              fill="white"
              fill-opacity="0.1"
            />
            <path
              d="M188.842 49.6416C188.292 48.1546 186.641 47.3952 185.154 47.9441L169.429 53.7574C166.045 55.0086 167.943 60.4258 171.42 59.1428L187.145 53.3295C188.632 52.7798 189.392 51.129 188.842 49.6416Z"
              fill="white"
              fill-opacity="0.1"
            />
          </svg>
        </div>
        <div className="flex gap-1 items-center  justify-start">
          <div className="flex flex-col justify-center h-[91px] gap-1">
            <p className="text-[10.79px] leading-tight flex justify-start font-light text-white">
              IncomeSharks just made a call for $ETH and has generated over
            </p>
            <p className="font-bold text-[27.75px]">
              $10,000
              <span className="text-[10.79px] -mt-3  flex justify-start font-normal text-white">
                in Buy
              </span>
            </p>
          </div>
          <div>
            <Image
              src={star}
              alt=""
              height={90}
              width={100}
              className="relative h-[91px] w-[91px] "
            />
          </div>
        </div>
      </div>
      <div className="flex flex-col xs:flex-row gap-3 items-start xs:items-center xs:justify-between py-4">
        <h2 className="text-[18px] text-mainColor font-semibold xs:whitespace-nowrap">
          Influencers Leaderboard
        </h2>
        <div className="flex items-center gap-2 justify-center xs:justify-end  w-full">
          <span className="h-[46px] w-[46px] rounded-full cursor-pointer bg-[#111736] flex items-center justify-center">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0_530_3599)">
                <path
                  d="M8.80758 0C3.95121 0 0 3.95121 0 8.80758C0 13.6642 3.95121 17.6152 8.80758 17.6152C13.6642 17.6152 17.6152 13.6642 17.6152 8.80758C17.6152 3.95121 13.6642 0 8.80758 0ZM8.80758 15.9892C4.8477 15.9892 1.62602 12.7675 1.62602 8.80762C1.62602 4.84773 4.8477 1.62602 8.80758 1.62602C12.7675 1.62602 15.9891 4.8477 15.9891 8.80758C15.9891 12.7675 12.7675 15.9892 8.80758 15.9892Z"
                  fill="#6E62E5"
                />
                <path
                  d="M19.762 18.6117L15.1007 13.9505C14.7831 13.6329 14.2687 13.6329 13.9511 13.9505C13.6335 14.2678 13.6335 14.7828 13.9511 15.1001L18.6124 19.7614C18.7711 19.9201 18.979 19.9996 19.1872 19.9996C19.395 19.9996 19.6031 19.9201 19.762 19.7614C20.0796 19.444 20.0796 18.9291 19.762 18.6117Z"
                  fill="#6E62E5"
                />
              </g>
              <defs>
                <clipPath id="clip0_530_3599">
                  <rect width="20" height="20" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </span>
          <span className="h-[46px] w-[46px] rounded-full cursor-pointer bg-[#111736] flex items-center justify-center">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0_530_3608)">
                <path
                  d="M1.58252 4.20375H10.798C11.0858 5.53312 12.2697 6.5325 13.6839 6.5325C15.0981 6.5325 16.282 5.53312 16.5699 4.20375H18.4178C18.763 4.20375 19.0428 3.92391 19.0428 3.57875C19.0428 3.23359 18.763 2.95375 18.4178 2.95375H16.5699C16.282 1.62437 15.0981 0.625 13.6839 0.625C12.2697 0.625 11.0858 1.62437 10.798 2.95375H1.58252C1.23736 2.95375 0.95752 3.23359 0.95752 3.57875C0.95752 3.92391 1.23736 4.20375 1.58252 4.20375ZM13.6839 1.875C14.6235 1.875 15.3877 2.63937 15.3877 3.57875C15.3877 4.51812 14.6233 5.2825 13.6839 5.2825C12.7445 5.2825 11.9802 4.51812 11.9802 3.57875C11.9802 2.63937 12.7444 1.875 13.6839 1.875Z"
                  fill="#6E62E5"
                />
                <path
                  d="M18.4178 9.37562H9.20236C8.91455 8.04625 7.73064 7.04688 6.31643 7.04688C4.90221 7.04688 3.7183 8.04625 3.43049 9.37562H1.58252C1.23736 9.37562 0.95752 9.65547 0.95752 10.0006C0.95752 10.3458 1.23736 10.6256 1.58252 10.6256H3.43049C3.7183 11.955 4.90221 12.9544 6.31643 12.9544C7.73064 12.9544 8.91455 11.955 9.20236 10.6256H18.4178C18.763 10.6256 19.0428 10.3458 19.0428 10.0006C19.0428 9.65547 18.763 9.37562 18.4178 9.37562ZM6.31643 11.7044C5.37689 11.7044 4.61268 10.94 4.61268 10.0006C4.61268 9.06125 5.37705 8.29687 6.31643 8.29687C7.2558 8.29687 8.02017 9.06109 8.02017 10.0006C8.02017 10.9402 7.25596 11.7044 6.31643 11.7044Z"
                  fill="#6E62E5"
                />
                <path
                  d="M18.4178 15.7975H16.5699C16.282 14.4681 15.0981 13.4688 13.6839 13.4688C12.2697 13.4688 11.0858 14.4681 10.798 15.7975H1.58252C1.23736 15.7975 0.95752 16.0773 0.95752 16.4225C0.95752 16.7677 1.23736 17.0475 1.58252 17.0475H10.798C11.0858 18.3769 12.2697 19.3762 13.6839 19.3762C15.0981 19.3762 16.282 18.3769 16.5699 17.0475H18.4178C18.763 17.0475 19.0428 16.7677 19.0428 16.4225C19.0428 16.0773 18.763 15.7975 18.4178 15.7975ZM13.6839 18.1262C12.7444 18.1262 11.9802 17.3619 11.9802 16.4225C11.9802 15.4831 12.7445 14.7187 13.6839 14.7187C14.6233 14.7187 15.3877 15.4831 15.3877 16.4225C15.3877 17.3619 14.6235 18.1262 13.6839 18.1262Z"
                  fill="#6E62E5"
                />
              </g>
              <defs>
                <clipPath id="clip0_530_3608">
                  <rect width="20" height="20" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </span>
        </div>
      </div>

      <div className="h-[54px] mb-2 rounded-[7px] bg-[#111736] mt-3 px-[16px] grid grid-cols-3 py-2">
        <h3 className="w-full xs:w-[65px] h-full -ml-4 xs:-ml-0 text-mainColor text-start flex items-center justify-center">
          S/N
        </h3>
        <h3 className="w-full xs:w-[231px] text-mainColor h-full flex items-center justify-start ml-6 xs:ml-0">
          Influencer
        </h3>
      </div>

      {LeaderboardItems.slice(0, 5).map((call, index) => (
        <CallDetails
          key={index}
          data={call}
          isOpen={openIndexes.includes(index)}
          toggleDropdown={() => toggleDropdown(index)}
        />
      ))}
    </div>
  );
};

export default LeaderBoardResponsive;
